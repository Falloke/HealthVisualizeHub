generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int             @id @default(autoincrement())
  first_name    String
  last_name     String
  role          String          @default("user")
  brith_date    DateTime
  position      String
  province      String
  email         String          @unique
  password      String
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  deletedAt     DateTime?
  Authenticator Authenticator[]
  sessions      Session[]

  // ‚¨áÔ∏è ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å saved_searches saved_searches[] ‡πÄ‡∏õ‡πá‡∏ô:
  savedSearches SavedSearch[] // ‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô camelCase ‡∏Å‡πá‡πÑ‡∏î‡πâ

  userSessions UserSession[]
}

model Session {
  sessionToken String   @unique
  expires      DateTime
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  userId       Int
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String
  expires    DateTime

  @@id([identifier, token])
}

model Authenticator {
  credentialID         String  @unique
  providerAccountId    String
  credentialPublicKey  String
  counter              Int
  credentialDeviceType String
  credentialBackedUp   Boolean
  transports           String?
  userId               Int
  user                 User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([userId, credentialID])
}

model influenzadata2567 {
  id             Int     @id @default(autoincrement())
  disease        String?
  gender         String?
  age_y          Int?
  nationality    String?
  occupation     String?
  province       String?
  district       String?
  onset_date     String?
  treated_date   String?
  diagnosis_date String?
  death_date     String?
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
model d01_influenza {
  id                    Int       @default(autoincrement())
  disease_code          String
  gender                String?
  age_y                 Int?
  nationality           String?
  occupation            String?
  province              String?
  district              String?
  onset_date            String?
  treated_date          String?
  diagnosis_date        String?
  death_date            String?
  onset_date_parsed     DateTime  @db.Date
  treated_date_parsed   DateTime? @db.Date
  diagnosis_date_parsed DateTime? @db.Date
  death_date_parsed     DateTime? @db.Date

  @@id([onset_date_parsed, id], map: "d01_influenza_v2_pkey")
}

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
// model d01_influenza_old {
//   disease_code          String?
//   gender                String?
//   age_y                 Int?
//   nationality           String?
//   occupation            String?
//   province              String?
//   district              String?
//   onset_date            String?
//   treated_date          String?
//   diagnosis_date        String?
//   death_date            String?
//   onset_date_parsed     DateTime  @db.Date
//   treated_date_parsed   DateTime? @db.Date
//   diagnosis_date_parsed DateTime? @db.Date
//   death_date_parsed     DateTime? @db.Date
//   diseases              diseases? @relation(fields: [disease_code], references: [code], onDelete: NoAction, onUpdate: NoAction, map: "d01_influenza_disease_code_fkey")

//   @@index([province], map: "idx_influenza_province")
//   @@ignore
// }

// model diseases {
//   code              String              @id
//   name_th           String
//   name_en           String
//   d01_influenza_old d01_influenza_old[]
// }

/// This table is a partition table and requires additional setup for migrations. Visit https://pris.ly/d/partition-tables for more info.
/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model influenza {
  id             Int       @default(autoincrement())
  disease        String?   @db.VarChar(100)
  gender         String?   @db.VarChar(10)
  age_y          Int?
  nationality    String?   @db.VarChar(50)
  occupation     String?
  province       String    @db.VarChar(100)
  district       String?   @db.VarChar(100)
  onset_date     DateTime  @db.Date
  treated_date   DateTime? @db.Date
  diagnosis_date DateTime? @db.Date
  death_date     DateTime? @db.Date

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model influenza_raw {
  disease            String?
  gender             String?
  age_y              Int?
  nationality        String?
  occupation         String?
  province           String?
  district           String?
  onset_date_raw     String?
  treated_date_raw   String?
  diagnosis_date_raw String?
  death_date_raw     String?
  onset_date         String? @db.VarChar(50)
  treated_date       String? @db.VarChar(50)
  diagnosis_date     String? @db.VarChar(50)
  death_date         String? @db.VarChar(50)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model influenza_staged {
  disease               String?
  gender                String?
  age_y                 Int?
  nationality           String?
  occupation            String?
  province              String?
  district              String?
  onset_date            String?
  treated_date          String?
  diagnosis_date        String?
  death_date            String?
  onset_date_parsed     DateTime? @db.Date
  treated_date_parsed   DateTime? @db.Date
  diagnosis_date_parsed DateTime? @db.Date
  death_date_parsed     DateTime? @db.Date

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model influenza_staged_2 {
  disease               String?
  gender                String?
  age_y                 Int?
  nationality           String?
  occupation            String?
  province              String?
  district              String?
  onset_date            String?
  treated_date          String?
  diagnosis_date        String?
  death_date            String?
  onset_date_parsed     DateTime? @db.Date
  treated_date_parsed   DateTime? @db.Date
  diagnosis_date_parsed DateTime? @db.Date
  death_date_parsed     DateTime? @db.Date

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model SavedSearch {
  id     BigInt @id @default(autoincrement())
  userId Int    @map("user_id")
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  searchName  String    @map("search_name")
  diseaseName String?   @map("disease_name")
  province    String?
  provinceAlt String?   @map("province_alt")
  startDate   DateTime? @map("start_date") @db.Date
  endDate     DateTime? @map("end_date") @db.Date
  color       String?   @db.Char(7)

  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @default(now()) @map("updated_at") @db.Timestamptz(6)

  @@index([searchName], map: "idx_saved_searches_search_name")
  @@index([userId, createdAt(sort: Desc)], map: "idx_saved_searches_user_created")
  @@map("saved_searches") // ‚Üê ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô DB
}

model UserSession {
  id     Int  @id @default(autoincrement())
  userId Int
  user   User @relation(fields: [userId], references: [id], onDelete: Cascade)

  startedAt      DateTime  @default(now())
  lastActivityAt DateTime?
  endedAt        DateTime?
  durationSec    Int?

  ip        String? @db.VarChar(255)
  userAgent String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("UserSession") // üëà ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô DB (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô DB ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á)
}
